<?xml version="1.0" encoding="UTF-8"?>
<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.1">
  <web>EESCCode</web>
  <name>EESCSkin</name>
  <language/>
  <defaultLanguage/>
  <parent>WebHome</parent>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1421919832000</creationDate>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1422361338000</date>
  <contentUpdateDate>1422361338000</contentUpdateDate>
  <version>1.1</version>
  <title>EESC Skin</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <content/>
  <attachment>
    <filename>uicomponents.widgets.userpicker.userPicker.js</filename>
    <author>XWiki.Admin</author>
    <date>1422361338000</date>
    <version>1.1</version>
    <comment/>
    <content>dmFyIFhXaWtpID0gKGZ1bmN0aW9uIGRlZmluZVVzZXJQaWNrZXIoWFdpa2kpIHsNCg0KLy8gU3RhcnQgWFdpa2kgYXVnbWVudGF0aW9uLg0KdmFyIHdpZGdldHMgPSBYV2lraS53aWRnZXRzOw0KLy8gVE9ETzogVXNlIHJlcXVpcmUuanMgaGVyZSB3aGVuIHdlIG1vdmUgYXdheSBmcm9tIFByb3RvdHlwZS5qcw0KaWYgKCF3aWRnZXRzIHx8ICF3aWRnZXRzLlN1Z2dlc3RQaWNrZXIpIHsNCiAgdmFyIHRyeUNvdW50ID0gYXJndW1lbnRzWzFdIHx8IDA7DQogIGlmICh0cnlDb3VudCA+IDUpIHsNCiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGVmaW5lIHRoZSBVc2VyUGlja2VyIG1vZHVsZTogcmVxdWlyZWQgZGVwZW5kZW5jeSBTdWdnZXN0UGlja2VyIGlzIG1pc3NpbmcuJyk7DQogIH0gZWxzZSB7DQogICAgc2V0VGltZW91dChkZWZpbmVVc2VyUGlja2VyLmJpbmQod2luZG93LCBYV2lraSwgdHJ5Q291bnQgKyAxKSwgMCk7DQogIH0NCiAgcmV0dXJuIFhXaWtpOw0KfQ0KDQovKioNCiAqIEV4dGVuZHMgdGhlIFN1Z2dlc3RQaWNrZXIgdG8gY3VzdG9taXplIHRoZSB3YXkgdGhlIHNlbGVjdGVkIHVzZXJzIGFyZSBkaXNwbGF5ZWQuDQogKi8NCnZhciBTZWxlY3Rpb25NYW5hZ2VyID0gQ2xhc3MuY3JlYXRlKHdpZGdldHMuU3VnZ2VzdFBpY2tlciwgew0KICAvLyBAT3ZlcnJpZGUNCiAgbWF0Y2hlc1NlbGVjdGVkVmFsdWU6IGZ1bmN0aW9uKHZhbHVlLCBzdWdnZXN0aW9uKSB7DQogICAgLy8gVGhlIGdpdmVuIHZhbHVlIGNhbiBiZSBhIHJlbGF0aXZlIHVzZXIgcmVmZXJlbmNlLiBXZSBuZWVkIHRvIHBhcnNlIGl0IGFuZCBtYXRjaCBvbmx5IHRoZSB1c2VyIGFsaWFzLg0KICAgIHJldHVybiBYV2lraS5Nb2RlbC5yZXNvbHZlKHZhbHVlLCBYV2lraS5FbnRpdHlUeXBlLkRPQ1VNRU5UKS5uYW1lID09IHN1Z2dlc3Rpb24uaWQ7DQogIH0sDQoNCiAgLy8gQE92ZXJyaWRlDQogIGdldERlZmF1bHRTdWdnZXN0aW9uOiBmdW5jdGlvbih2YWx1ZSkgew0KICAgIHZhciB1c2VyUmVmZXJlbmNlID0gWFdpa2kuTW9kZWwucmVzb2x2ZSh2YWx1ZSwgWFdpa2kuRW50aXR5VHlwZS5ET0NVTUVOVCk7DQogICAgcmV0dXJuIHsNCiAgICAgIGlkOiB1c2VyUmVmZXJlbmNlLm5hbWUsDQogICAgICB2YWx1ZTogdmFsdWUsDQogICAgICBpbmZvOiB1c2VyUmVmZXJlbmNlLm5hbWUsDQogICAgICBpY29uOiAiJHh3aWtpLmdldFNraW5GaWxlKCdpY29ucy94d2lraS9ub2F2YXRhci5wbmcnKSINCiAgICB9Ow0KICB9LA0KDQogIC8vIEBPdmVycmlkZQ0KICBhZGRJdGVtOiBmdW5jdGlvbigkc3VwZXIsIHN1Z2dlc3Rpb24pIHsNCiAgICAvLyBDbGVhciB0aGUgcHJldmlvdXNseSBzZWxlY3RlZCB1c2VyIGluIHNpbmdsZSBzZWxlY3Rpb24gbW9kZS4NCiAgICB0aGlzLmlucHV0Lmhhc0NsYXNzTmFtZSgnbXVsdGlwbGVTZWxlY3Rpb24nKSB8fCB0aGlzLmxpc3QudXBkYXRlKCcnKTsNCiAgICAkc3VwZXIoc3VnZ2VzdGlvbik7DQogIH0sDQoNCiAgLy8gQE92ZXJyaWRlDQogIGRpc3BsYXlJdGVtOiBmdW5jdGlvbihzdWdnZXN0aW9uKSB7DQogICAgdmFyIGl0ZW1EaXNwbGF5ID0gdGhpcy5zdWdnZXN0LmNyZWF0ZUl0ZW1EaXNwbGF5KHN1Z2dlc3Rpb24sIHt9KTsNCiAgICBpdGVtRGlzcGxheS5kb3duKCcudXNlci1uYW1lJykuaW5zZXJ0KHRoaXMuY3JlYXRlRGVsZXRlVG9vbCgpKTsNCiAgICByZXR1cm4gbmV3IEVsZW1lbnQoJ2xpJykuaW5zZXJ0KGl0ZW1EaXNwbGF5KS5pbnNlcnQodGhpcy5jcmVhdGVJdGVtSW5wdXQoc3VnZ2VzdGlvbikpOw0KICB9DQp9KTsNCg0KLyoqDQogKiBFbmhhbmNlcyBhIHBsYWluIEhUTUwgdGV4dCBpbnB1dCB3aXRoIHRoZSBhYmlsaXR5IHRvIHN1Z2dlc3QgdXNlcnMuDQogKi8NCndpZGdldHMuVXNlclBpY2tlciA9IENsYXNzLmNyZWF0ZSh3aWRnZXRzLlN1Z2dlc3QsIHsNCiAgLy8gQE92ZXJyaWRlDQogIGluaXRpYWxpemU6IGZ1bmN0aW9uKCRzdXBlciwgaW5wdXQsIG9wdGlvbnMpIHsNCiAgICAkc3VwZXIoaW5wdXQsIE9iamVjdC5leHRlbmQoew0KICAgICAgdmFybmFtZTogImlucHV0IiwNCiAgICAgIGVuYWJsZUhpZGVCdXR0b246IGZhbHNlLA0KICAgICAgdGltZW91dDogMzAwMDANCiAgICB9LCBvcHRpb25zIHx8IHt9KSk7DQoNCiAgICB2YXIgbGlzdEluc2VydGlvbkVsZW1lbnQgPSBpbnB1dDsNCiAgICAvLyBUaGUgc2NvcGUgdG9nZ2xlIGRvZXNuJ3QgbWFrZSBzZW5zZSB3aGVuIGdsb2JhbCB1c2VycyBhcmUgcmVxdWlyZWQuDQogICAgaWYgKGlucHV0Lmhhc0NsYXNzTmFtZSgnd2l0aFNjb3BlJykgJiYgIWlucHV0Lmhhc0NsYXNzTmFtZSgnZ2xvYmFsJykpIHsNCiAgICAgIHRoaXMuX3NvdXJjZVVSTCA9IG9wdGlvbnMuc2NyaXB0Ow0KICAgICAgdGhpcy5fY3JlYXRlU2NvcGUoKTsNCiAgICAgIGxpc3RJbnNlcnRpb25FbGVtZW50ID0gaW5wdXQudXAoKTsNCiAgICB9DQogICAgdGhpcy5fc2VsZWN0aW9uTWFuYWdlciA9IHRoaXMuX2NyZWF0ZVNlbGVjdGlvbk1hbmFnZXIoew0KICAgICAgbGlzdEluc2VydGlvbkVsZW1lbnQ6IGxpc3RJbnNlcnRpb25FbGVtZW50LA0KICAgICAgbGlzdEluc2VydGlvblBvc2l0aW9uIDogJ2JlZm9yZScsDQogICAgICBhY2NlcHRGcmVlVGV4dCA6IHRydWUNCiAgICB9KTsNCiAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uID0gaW5wdXQuaGFzQ2xhc3NOYW1lKCdtdWx0aXBsZVNlbGVjdGlvbicpOw0KICAgIC8vIEtlZXAgYSByZWZlcmVuY2UgdG8gdGhpcyB1c2VyIHBpY2tlciBpbnN0YW5jZSBpZiB0aGUgdGFyZ2V0IGlucHV0IGhhcyB0aGUgSUQgYXR0cmlidXRlIHNwZWNpZmllZC4NCiAgICBpZiAoaW5wdXQuaWQgIT0gJycpIHsNCiAgICAgIHdpZGdldHMuVXNlclBpY2tlci5pbnN0YW5jZXNbaW5wdXQuaWRdID0gdGhpczsNCiAgICB9DQogIH0sDQoNCiAgLy8gQE92ZXJyaWRlDQogIGNyZWF0ZUl0ZW1EaXNwbGF5OiBmdW5jdGlvbihkYXRhLCBzb3VyY2UpIHsNCiAgICB2YXIgY29udGFpbmVyID0gbmV3IEVsZW1lbnQoJ2RpdicsIHsnY2xhc3MnOiAndXNlcid9KTsNCiAgICB2YXIgYXZhdGFyV3JhcHBlciA9IG5ldyBFbGVtZW50KCdkaXYnLCB7J2NsYXNzJzogJ3VzZXItYXZhdGFyLXdyYXBwZXInfSk7DQogICAgYXZhdGFyV3JhcHBlci5pbnNlcnQobmV3IEVsZW1lbnQoJ2ltZycsIHtzcmM6IGRhdGEuaWNvbiwgYWx0OiBkYXRhLmluZm8sICdjbGFzcyc6ICdpY29uJ30pKTsNCiAgICBjb250YWluZXIuaW5zZXJ0KGF2YXRhcldyYXBwZXIpOw0KICAgIHZhciB1c2VyTmFtZSA9IHNvdXJjZS5oaWdobGlnaHQgPyB0aGlzLmVtcGhhc2l6ZU1hdGNoZXModGhpcy5zSW5wdXQsIGRhdGEuaW5mbykgOiBkYXRhLmluZm87DQogICAgY29udGFpbmVyLmluc2VydChuZXcgRWxlbWVudCgnZGl2JywgeydjbGFzcyc6ICd1c2VyLW5hbWUnfSkudXBkYXRlKHVzZXJOYW1lKSk7DQogICAgdmFyIHVzZXJBbGlhcyA9IHNvdXJjZS5oaWdobGlnaHQgPyB0aGlzLmVtcGhhc2l6ZU1hdGNoZXModGhpcy5zSW5wdXQsIGRhdGEuaWQpIDogZGF0YS5pZDsNCiAgICBjb250YWluZXIuaW5zZXJ0KG5ldyBFbGVtZW50KCdkaXYnLCB7J2NsYXNzJzogJ3VzZXItYWxpYXMnfSkudXBkYXRlKHVzZXJBbGlhcykpOw0KICAgIHJldHVybiBjb250YWluZXI7DQogIH0sDQoNCiAgLyoqDQogICAqIENsZWFycyB0aGUgY29udGVudCBvZiB0aGUgdGFyZ2V0IGlucHV0IGFuZCB0aGUgY3VycmVudCBzZWxlY3Rpb24uDQogICAqLw0KICBjbGVhciA6IGZ1bmN0aW9uKCkgew0KICAgIHRoaXMuZmxkLmNsZWFyKCk7DQogICAgdGhpcy5fc2VsZWN0aW9uTWFuYWdlci5jbGVhckFjY2VwdGVkTGlzdCgpOw0KICB9LA0KDQogIC8qKg0KICAgKiBEZXRlcm1pbmVzIHRoZSBzZWxlY3Rpb24gbWFuYWdlciB0aGF0IGlzIGdvaW5nIHRvIGJlIHVzZWQuIERlcml2ZWQgY2xhc3NlcyBjYW4gb3ZlcnJpZGUgdGhpcyBtZXRob2QgaWYgdGhleSB3YW50DQogICAqIHRvIHVzZSBhIGRpZmZlcmVudCBzZWxlY3Rpb24gbWFuYWdlci4NCiAgICovDQogIF9jcmVhdGVTZWxlY3Rpb25NYW5hZ2VyOiBmdW5jdGlvbihvcHRpb25zKSB7DQogICAgcmV0dXJuIG5ldyBTZWxlY3Rpb25NYW5hZ2VyKHRoaXMuZmxkLCB0aGlzLCBvcHRpb25zKTsNCiAgfSwNCg0KICBfY3JlYXRlU2NvcGU6IGZ1bmN0aW9uKCkgew0KICAgIHRoaXMuX3Njb3BlID0gbmV3IEVsZW1lbnQoJ2lucHV0Jywgew0KICAgICAgdHlwZTogJ2ltYWdlJywNCiAgICAgICdjbGFzcyc6ICdzY29wZScsDQogICAgICBhbHQ6ICIkc2VydmljZXMubG9jYWxpemF0aW9uLnJlbmRlcignY29yZS53aWRnZXRzLnVzZXJQaWNrZXIuc2NvcGVIaW50JykiLA0KICAgICAgdGl0bGU6ICIkc2VydmljZXMubG9jYWxpemF0aW9uLnJlbmRlcignY29yZS53aWRnZXRzLnVzZXJQaWNrZXIuc2NvcGVIaW50JykiDQogICAgfSk7DQogICAgLy8gR3JvdXAgdGhlIHNjb3BlIGFuZCB0aGUgaW5wdXQuDQogICAgdmFyIHdyYXBwZXIgPSBuZXcgRWxlbWVudCgnc3BhbicpLmluc2VydCh0aGlzLl9zY29wZSk7DQogICAgdGhpcy5mbGQuaW5zZXJ0KHtiZWZvcmU6IHdyYXBwZXJ9KTsNCiAgICB3cmFwcGVyLmluc2VydCh0aGlzLmZsZCk7DQogICAgLy8gQWRkIGNsaWNrIGhhbmRsZXIuDQogICAgdGhpcy5fc2NvcGUub2JzZXJ2ZSgnY2xpY2snLCB0aGlzLl90b2dnbGVTY29wZS5iaW5kQXNFdmVudExpc3RlbmVyKHRoaXMpKTsNCiAgICAvLyBJbml0aWFsaXplIHRoZSBzY29wZSB2YWx1ZS4NCiAgICB0aGlzLl90b2dnbGVTY29wZSgpOw0KICB9LA0KDQogIC8qKg0KICAgKiBUb2dnbGVzIGJldHdlZW4gbG9jYWwgYW5kIGdsb2JhbCBzY29wZS4NCiAgICovDQogIF90b2dnbGVTY29wZTogZnVuY3Rpb24oZXZlbnQpIHsNCiAgICBldmVudCAmJiBldmVudC5zdG9wKCk7DQogICAgaWYgKHRoaXMuX3Njb3BlLnZhbHVlID09ICdsb2NhbCcpIHsNCiAgICAgIHRoaXMuX3Njb3BlLnZhbHVlID0gJ2dsb2JhbCc7DQogICAgICB0aGlzLl9zY29wZS5zcmMgPSAiJHh3aWtpLmdldFNraW5GaWxlKCdpY29ucy9zaWxrL3dvcmxkLnBuZycpIjsNCiAgICB9IGVsc2Ugew0KICAgICAgdGhpcy5fc2NvcGUudmFsdWUgPSAnbG9jYWwnOw0KICAgICAgdGhpcy5fc2NvcGUuc3JjID0gIiR4d2lraS5nZXRTa2luRmlsZSgnaWNvbnMvc2lsay93b3JsZF9kZWxldGUucG5nJykiOw0KICAgIH0NCiAgICB0aGlzLnNvdXJjZXNbMF0uc2NyaXB0ID0gdGhpcy5fc291cmNlVVJMICsgJ3dpa2k9JyArIHRoaXMuX3Njb3BlLnZhbHVlICsgJyYnOw0KICB9LA0KDQogIC8vIEBPdmVycmlkZQ0KICBkZXRhY2g6IGZ1bmN0aW9uKCRzdXBlcikgew0KICAgIC8vIFJlbW92ZSB0aGUgbGlzdCBvZiBhY2NlcHRlZCBzdWdnZXN0aW9ucy4NCiAgICB0aGlzLl9zZWxlY3Rpb25NYW5hZ2VyICYmIHRoaXMuX3NlbGVjdGlvbk1hbmFnZXIuZGV0YWNoKCk7DQoNCiAgICAvLyBSZW1vdmUgdGhlIHNjb3BlIHRvZ2dsZS4NCiAgICB0aGlzLl9zY29wZSAmJiB0aGlzLl9zY29wZS5zdG9wT2JzZXJ2aW5nKCdjbGljaycpLnVwKCkuaW5zZXJ0KHtiZWZvcmU6IHRoaXMuZmxkfSkucmVtb3ZlKCk7DQoNCiAgICAkc3VwZXIoKTsNCiAgfQ0KfSk7DQovLyBVc2VkIHRvIGFjY2VzcyB0aGUgY3JlYXRlZCB1c2VyIHBpY2tlcnMuDQp3aWRnZXRzLlVzZXJQaWNrZXIuaW5zdGFuY2VzID0ge307DQoNCnZhciBpbml0ID0gZnVuY3Rpb24oZXZlbnQpIHsNCiAgdmFyIHByb2plY3RGaWx0ZXIgPSAiIjsNCiAgaWYoJCgnVGFza01hbmFnZXIuVGFza01hbmFnZXJDbGFzc18wX3Byb2plY3QnKSAmJiAkKCdUYXNrTWFuYWdlci5UYXNrTWFuYWdlckNsYXNzXzBfcHJvamVjdCcpLnZhbHVlICE9ICIiKXsNCgkgcHJvamVjdEZpbHRlciA9ICImcHJvamVjdD0iICsgJCgnVGFza01hbmFnZXIuVGFza01hbmFnZXJDbGFzc18wX3Byb2plY3QnKS52YWx1ZTsNCiAgfQ0KICB2YXIgc3VnZ2VzdGlvbnNNYXBwaW5nID0gew0KICAgIHVzZXJzOiB7DQogICAgICBzY3JpcHQ6IFhXaWtpLmN1cnJlbnREb2N1bWVudC5nZXRVUkwoJ2dldCcsICd4cGFnZT11b3Jnc3VnZ2VzdCZ1b3JnPXVzZXInICsgcHJvamVjdEZpbHRlciArICcmJyksDQogICAgICBub3Jlc3VsdHM6ICIkc2VydmljZXMubG9jYWxpemF0aW9uLnJlbmRlcignY29yZS53aWRnZXRzLnVzZXJQaWNrZXIubm9SZXN1bHRzJykiDQogICAgfSwNCiAgICBncm91cHM6IHsNCiAgICAgIHNjcmlwdDogWFdpa2kuY3VycmVudERvY3VtZW50LmdldFVSTCgnZ2V0JywgJ3hwYWdlPXVvcmdzdWdnZXN0JnVvcmc9Z3JvdXAmJyksDQogICAgICBub3Jlc3VsdHM6ICIkc2VydmljZXMubG9jYWxpemF0aW9uLnJlbmRlcignY29yZS53aWRnZXRzLmdyb3VwUGlja2VyLm5vUmVzdWx0cycpIg0KICAgIH0NCiAgfQ0KICB2YXIgY29udGFpbmVycyA9IChldmVudCAmJiBldmVudC5tZW1vLmVsZW1lbnRzKSB8fCBbJCgnYm9keScpXTsNCiAgT2JqZWN0LmtleXMoc3VnZ2VzdGlvbnNNYXBwaW5nKS5lYWNoKGZ1bmN0aW9uKGtleSkgew0KICAgIGNvbnRhaW5lcnMuZWFjaChmdW5jdGlvbihjb250YWluZXIpIHsNCiAgICAgIGNvbnRhaW5lci5zZWxlY3QoJ2lucHV0LnN1Z2dlc3QnICsga2V5LmNhcGl0YWxpemUoKSkuZWFjaChmdW5jdGlvbihpbnB1dCkgew0KICAgICAgICBpZiAoIWlucHV0Lmhhc0NsYXNzTmFtZSgnaW5pdGlhbGl6ZWQnKSkgew0KICAgICAgICAgIHZhciBvcHRpb25zID0gT2JqZWN0LmNsb25lKHN1Z2dlc3Rpb25zTWFwcGluZ1trZXldKTsNCiAgICAgICAgICAvLyBUaGUgcGlja2VyIHN1Z2dlc3RzIGJ5IGRlZmF1bHQgbG9jYWwgdXNlcnMgb3IgZ3JvdXBzLg0KICAgICAgICAgIGlmIChpbnB1dC5oYXNDbGFzc05hbWUoJ2dsb2JhbCcpKSB7DQogICAgICAgICAgICAvLyBTdWdnZXN0IGdsb2JhbCB1c2VycyBvciBncm91cHMuDQogICAgICAgICAgICBvcHRpb25zLnNjcmlwdCA9IG9wdGlvbnMuc2NyaXB0ICsgJ3dpa2k9Z2xvYmFsJic7DQogICAgICAgICAgfQ0KICAgICAgICAgIG5ldyB3aWRnZXRzLlVzZXJQaWNrZXIoaW5wdXQsIG9wdGlvbnMpOw0KICAgICAgICAgIGlucHV0LmFkZENsYXNzTmFtZSgnaW5pdGlhbGl6ZWQnKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSk7DQogIH0pOw0KICByZXR1cm4gdHJ1ZTsNCn07DQooWFdpa2kuZG9tSXNMb2FkZWQgJiYgaW5pdCgpKSB8fCBkb2N1bWVudC5vYnNlcnZlKCd4d2lraTpkb206bG9hZGVkJywgaW5pdCk7DQpkb2N1bWVudC5vYnNlcnZlKCd4d2lraTpkb206dXBkYXRlZCcsIGluaXQpOw0KaWYoJCgnVGFza01hbmFnZXIuVGFza01hbmFnZXJDbGFzc18wX3Byb2plY3QnKSl7DQoJJCgnVGFza01hbmFnZXIuVGFza01hbmFnZXJDbGFzc18wX3Byb2plY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpew0KCQljb25zb2xlLmxvZygkJCgnaW5wdXQuc3VnZ2VzdFVzZXJzJykpOw0KCQkkJCgnaW5wdXQuc3VnZ2VzdFVzZXJzJykuaW52b2tlKCdyZW1vdmVDbGFzc05hbWUnLCAnaW5pdGlhbGl6ZWQnKTsNCgkJaW5pdCgpOw0KCX0sIGZhbHNlKTsNCn0NCi8vIEVuZCBYV2lraSBhdWdtZW50YXRpb24uDQpyZXR1cm4gWFdpa2k7DQp9KShYV2lraSB8fCB7fSk7DQo=</content>
    <filesize>7574</filesize>
  </attachment>
  <object>
    <name>EESCCode.EESCSkin</name>
    <number>0</number>
    <className>XWiki.XWikiSkins</className>
    <guid>c864391c-532a-4f45-bba6-475855ed53c1</guid>
    <class>
      <name>XWiki.XWikiSkins</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <baseskin>
        <customDisplay/>
        <disabled>0</disabled>
        <name>baseskin</name>
        <number>2</number>
        <picker>0</picker>
        <prettyName>Base Skin</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </baseskin>
      <contentview.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>contentview.vm</name>
        <number>17</number>
        <picker>0</picker>
        <prettyName>contentview.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </contentview.vm>
      <docdoesnotexist.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>docdoesnotexist.vm</name>
        <number>13</number>
        <picker>0</picker>
        <prettyName>docdoesnotexist.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </docdoesnotexist.vm>
      <edit.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>edit.vm</name>
        <number>9</number>
        <picker>0</picker>
        <prettyName>Edit</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </edit.vm>
      <editinline.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>editinline.vm</name>
        <number>10</number>
        <picker>0</picker>
        <prettyName>editinline.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </editinline.vm>
      <eescHeader.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>eescHeader.vm</name>
        <number>14</number>
        <picker>0</picker>
        <prettyName>eescHeader.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </eescHeader.vm>
      <eescTitle.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>eescTitle.vm</name>
        <number>15</number>
        <picker>0</picker>
        <prettyName>eescTitle.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </eescTitle.vm>
      <footer.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>footer.vm</name>
        <number>6</number>
        <picker>0</picker>
        <prettyName>Footer</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </footer.vm>
      <header.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>header.vm</name>
        <number>5</number>
        <picker>0</picker>
        <prettyName>Header</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </header.vm>
      <layoutExtraVars.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>layoutExtraVars.vm</name>
        <number>11</number>
        <picker>0</picker>
        <prettyName>layoutExtraVars.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </layoutExtraVars.vm>
      <logo>
        <customDisplay/>
        <disabled>0</disabled>
        <name>logo</name>
        <number>3</number>
        <picker>0</picker>
        <prettyName>Logo</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </logo>
      <name>
        <customDisplay/>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <picker>0</picker>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <preview.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>preview.vm</name>
        <number>12</number>
        <picker>0</picker>
        <prettyName>preview.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </preview.vm>
      <style.css>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>style.css</name>
        <number>4</number>
        <picker>0</picker>
        <prettyName>Style</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </style.css>
      <uorgsuggest.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>uorgsuggest.vm</name>
        <number>16</number>
        <picker>0</picker>
        <prettyName>uorgsuggest.vm</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </uorgsuggest.vm>
      <view.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>view.vm</name>
        <number>8</number>
        <picker>0</picker>
        <prettyName>View</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </view.vm>
      <viewheader.vm>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>viewheader.vm</name>
        <number>7</number>
        <picker>0</picker>
        <prettyName>View Header</prettyName>
        <rows>15</rows>
        <size>80</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </viewheader.vm>
    </class>
    <property>
      <baseskin>flamingo</baseskin>
    </property>
    <property>
      <contentview.vm>###
### Display document contents in "view" mode.
###
## -------------------------------
## Compute the content to display 
## -------------------------------
## Honor the syntax if it's passed in the request.
#set($outputSyntax = $xwiki.getAvailableRendererSyntax($request.outputSyntax, $request.outputSyntaxVersion))
#if ($outputSyntax)
  ## If the passed syntax is not an HTML-compatible syntax we need to HTML-escape it so that it can be 
  ## displayed fine in HTML (since at the point this vm file is called we're already inside an HTML page with
  ## panels on the side, header, etc).
  #set($syntaxType = $outputSyntax.type.toIdString())
  #if (($syntaxType == "xhtml") || ($syntaxType == "html"))
    #set ($renderedContent = $tdoc.getRenderedContent($outputSyntax))
  #else
    ## Make sure to print correctly the result when it's not HTML
    #set ($renderedContent = "&lt;pre&gt;$escapetool.html($tdoc.getRenderedContent($outputSyntax))&lt;/pre&gt;")
  #end
#else
  #set ($renderedContent = $tdoc.getRenderedContent())
#end
## ----------------------------------------------------------------------------
## Compute title to display and modify rendered content accordingly.
## ----------------------------------------------------------------------------
#template("titlevars.vm")
## ----------------------------
## Display the title
## ----------------------------
&lt;div class="xcontent"&gt;
  &lt;div class="row document-header"&gt;
    &lt;div class="document-info col-xs-12 #if($displayContentMenu)col-md-7#end"&gt;
      #if($doc.getObject("ProjectsCode.ProjectsCodeClass") &amp;&amp; !$doc.fullName.equals('ProjectsCode.ProjectsCodeTemplate'))
		#set($titleToDisplay = "[${services.localization.render('ProjectsCode.app.title')}] " + $titleToDisplay)
	  #end
	  &lt;div id="document-title"&gt;&lt;h1&gt;$titleToDisplay&lt;/h1&gt;&lt;/div&gt;
      &lt;div class="xdocLastModification"&gt;
        $services.localization.render('core.footer.modification', [$xwiki.getUserName($tdoc.author), $xwiki.formatDate($tdoc.date)])
      &lt;/div&gt;
    &lt;/div&gt;
    #if($displayContentMenu)
      &lt;div class="document-menu col-xs-12 col-md-5"&gt;
        #template("menus_content.vm")
      &lt;/div&gt;
    #end
  &lt;/div&gt;
  &lt;hr/&gt;
  ## --------------------------------------------------------------------------
  ## Drop permissions as they are no longer needed. This allows us not to have
  ## to review the code below for security holes since nothing bad can happen.
  ## --------------------------------------------------------------------------
  $xcontext.dropPermissions()
  ## ----------------------------
  ## Display the rendered content
  ## ----------------------------
  &lt;div class="row"&gt;
    &lt;div id="xwikicontent" class="col-xs-12"&gt;
      $renderedContent
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
## -----------------------------------------------------------------------------------
## Display the footnotes if the document is in 1.0 syntax and if there are any defined
## -----------------------------------------------------------------------------------
#set($footnotes = "#putFootnotes()")
$xwiki.renderText($footnotes, $doc)
</contentview.vm>
    </property>
    <property>
      <docdoesnotexist.vm>###
### Document does not exist message
###
###
#if ($services.distribution.jobStatus &amp;&amp; $services.distribution.jobStatus.state.name() != 'FINISHED' &amp;&amp; $services.distribution.canDisplayDistributionWizard())
  $response.sendRedirect($xwiki.getURL('XWiki.Distribution', 'distribution', "xredirect=$escapetool.url($xwiki.relativeRequestURL)"))
#else
  #set($documentredirectref = $services.model.createDocumentReference($xcontext.mainWikiName, 'Main', 'WebHome'))
  $response.sendRedirect($xwiki.getURL($documentredirectref))
#end
</docdoesnotexist.vm>
    </property>
    <property>
      <edit.vm>###
### Main "edit" template
###
### General wrapper for edit actions
###
##
## Is the document being edited by another user?
## If yes, warn about it and show a forcing link:
##
#if($tdoc.getLocked() &amp;&amp; "$!request.get('force')" == '')
  #template("startpage.vm")
  &lt;div class="main"&gt;
   &lt;div id="mainContentArea"&gt;
    ##
    $response.setStatus(423)
    #set($newquerystring = "$!{request.getQueryString().replaceAll('&amp;', '&amp;amp;').replaceAll('&amp;amp;amp;', '&amp;amp;')}"
                         + '&amp;amp;force=1')
    #set($forceEditURL = $doc.getURL($xcontext.getAction(), ${newquerystring}))
    #xwikimessageboxstart($services.localization.render('notice') "$services.localization.render('doclockedby') $xwiki.getUserName($doc.getLockingUser())")
    &lt;a href="$forceEditURL"&gt;$services.localization.render('forcelock')&lt;/a&gt;
    #xwikimessageboxend()
    ##
   &lt;/div&gt;## mainContentArea
  &lt;/div&gt;## main
  #template("endpage.vm")
#else
  ##
  ## Determine what editor to show
  ##
  #if("$!editor" == '')
    ## Normally no special characters should exist in the editor parameter, so this is just a protection measure.
    #set($editor = "$!{escapetool.xml($request.getParameter('editor'))}")
    #if($editor == '')
      ## Determine the sheets using the default document translation because objects are accessible only from the default translation.
      #if(!$services.sheet.getSheets($doc, $xcontext.action).isEmpty())
        #set($editor = 'inline')
      #elseif (($xwiki.getUserPreference('editor') == 'Wysiwyg') &amp;&amp; ($tdoc.syntax.toIdString() == 'xwiki/1.0' &amp;&amp; !$tdoc.isAdvancedContent() || $services.wysiwyg.isSyntaxSupported($tdoc.syntax.toIdString())))
        #set($editor = 'wysiwyg')
      #else
        #set($editor = 'wiki')
      #end
    #end
  #end
  #if($editor == 'inline')
    ## The inline editor uses the view layout, unlike the rest of the editors.
    #template('startpage.vm')
    #template('editinline.vm')
    #template('endpage.vm')
  #else
  ##
  ## "Compute" the title
  ##
  #set ($title = $services.localization.render("platform.web.editors.${editor}.pageTitle", [$tdoc.plainTitle]))
  #if ($title == "platform.web.editors.${editor}.pageTitle")
    #set ($title = $services.localization.render('platform.web.editors.unknown.pageTitle', [$tdoc.plainTitle]))
  #end
  ##
  ## Header
  ##
  #template("xwikivars.vm")
  #template("layoutvars.vm")
  #template("htmlheader.vm")
  #if($displayMainMenu)
    &lt;div id="menuview"&gt;
      #template("menus_view.vm")
    &lt;/div&gt;
  #end
  #template("header.vm")
  #if($editor == 'wiki' || $editor == 'wysiwyg')
    &lt;form id="edit" method="post" action="$doc.getURL('preview')" class="withLock form"&gt;
    &lt;div class="hidden"&gt;
    ## CSRF prevention
    &lt;input type="hidden" name="form_token" value="$!{services.csrf.getToken()}" /&gt;
    ## Pass the section number when the form is submitted in order to affect only the specified section.
    ## We need to test if the section number is present to prevent a NumberFormatException for the empty string.
    #if("$!{request.section}" != '')
      &lt;input type="hidden" name="section" value="$!{escapetool.xml($request.section)}" /&gt;
    #end
    ## This input is used by the full screen widget: it stores the selector of the maximized element, so that the full screen can be restored when coming back from preview.
    &lt;input type="hidden" name="x-maximized" value="$!{escapetool.xml($request.get('x-maximized'))}"/&gt;
    &lt;/div&gt;
  #end
  ##################
  ##   Edit zone  ##
  ##################
  &lt;div id="xwikieditor"&gt;
  &lt;div id="xwikieditorinner"&gt;
  &lt;div class="leftsidecolumns main"&gt;
  &lt;div id="editcolumn" class="editor editor-${editor}"&gt;
  &lt;div class="alleditcontent"&gt;
  &lt;div id="mainEditArea"&gt;
  #if($editor == 'wiki' || $editor == 'wysiwyg' || $editor == 'inline')
    &lt;div class='edit-meta-tools'&gt;
      &lt;a id='editParentTrigger' class='tool edit-parent' href='#mainEditArea' title="$services.localization.render('core.editors.content.parentField.edit.title')"&gt;[$services.localization.render('core.editors.content.parentField.edit')]&lt;/a&gt;
    &lt;/div&gt;
  #end
  #template("eescTitle.vm")
  #template("hierarchy.vm")
  &lt;div class="row"&gt;
    #if (($editor == 'wiki' || $editor == 'wysiwyg') &amp;&amp; !$request.section)
      &lt;div id="editMeta" class="col-xs-12 col-md-7"&gt;
        #template('editmeta.vm')
      &lt;/div&gt;
    #else
      &lt;div id="document-title" class="col-xs-12 col-md-7"&gt;&lt;h1&gt;
      #if($editor == 'rights')
        $services.localization.render('core.editors.rights.title', [$escapetool.xml($doc.plainTitle), $doc.getURL()])
      #elseif($editor == 'object')
        $services.localization.render('core.editors.object.title', [$escapetool.xml($doc.plainTitle), $doc.getURL()])
      #elseif($editor == 'class')
        $services.localization.render('core.editors.class.title', [$escapetool.xml($doc.fullName), $doc.getURL()])
      #end
      &lt;/h1&gt;&lt;/div&gt;
    #end
    #if($displayContentMenu)
      &lt;div class="col-xs-12 col-md-5"&gt;
        #template("menus_content.vm")
      &lt;/div&gt;
    #end
  &lt;/div&gt; ## row
  #template("edit${editor}.vm")
  ## This javascript must be placed here since it uses velocity variables set in the template above.
  &lt;script type="text/javascript"&gt;
    //&lt;![CDATA[
    if ($('tmEditWysiwyg')) {
      // Manage switch from wiki to wysiwyg, content must be preserved between those editors.
      Event.observe($('tmEditWysiwyg'), "click", function(event) {
        #if($doc.syntax.toIdString() == "xwiki/1.0")
        if (checkAdvancedContent("$services.localization.render('checkadvancedcontent')") == false) {
          Event.stop(event);
          return;
        }
        #end
        document.forms.${formname}.action='$doc.getURL("edit", "editor=wysiwyg&amp;$languageparams")';
        document.forms.${formname}.submit();
        Event.stop(event);
      });

      // Manage switch from wysiwyg to wiki, content must be preserved between those editors.
      Event.observe($('tmEditWiki'), "click", function(event) {
        document.forms.${formname}.action='$doc.getURL("edit", "editor=wiki&amp;$languageparams")';
        document.forms.${formname}.submit();
        Event.stop(event);
      });
    }
    //]]&gt;
  &lt;/script&gt;
  &lt;/div&gt; ## mainEditArea
  &lt;/div&gt; ## alleditcontent
  &lt;/div&gt; ## editcolumn
  &lt;div class="clearfix"&gt;&lt;/div&gt;
  &lt;/div&gt; ## leftsidecolumns
  #template("editpanels.vm")
  &lt;div class="clearfix"&gt;&lt;/div&gt;
  &lt;/div&gt; ## xwikieditorinner
  &lt;/div&gt; ## xwikieditor
  ##
  ## Footer
  ##
  #if($editor == 'wiki' || $editor == 'wysiwyg')
    &lt;/form&gt;
  #end
  #template("footer.vm")
  #template("htmlfooter.vm")
  #end ## $editor != 'inline'
#end
</edit.vm>
    </property>
    <property>
      <editinline.vm>## Insert JS and CSS needed for the fullscreen edit feature
$xwiki.jsfx.use('uicomponents/widgets/fullScreen.js', {'forceSkinAction': true, 'language': ${xcontext.language}})##
$xwiki.ssfx.use('uicomponents/widgets/fullScreen.css', true)##
#set($formname = "inline")
#set($saveaction = "save")
#set($previewenabled = true)
## Determine if editing should be allowed
#set($force = $!request.get("force"))
#set($allowDocEdit = !(($doc.getLocked()==true)&amp;&amp;(!$force)) )
##
&lt;div class="main"&gt;
&lt;div id="mainContentArea"&gt;
## ----------------------------------------------------------------------------
## Start FORM at start of content area IF editing is allowed.
## ----------------------------------------------------------------------------
#if ($allowDocEdit)
 &lt;form id="inline" method="post" action="$doc.getURL("preview")" class="withLock"&gt;
#end
#template("eescTitle.vm")
#template("hierarchy.vm")
&lt;div class="row"&gt;
  &lt;div id="editMeta" class="col-xs-12 col-md-7"&gt;
    #template('editmeta.vm')
    ## ----------------------------------------------------------------------------
    ## Compute title to display and modify rendered content accordingly.
    ## ----------------------------------------------------------------------------
    #set ($renderedContent = $cdoc.getRenderedContent())
    #template("titlevars.vm")
    ## ----------------------------
    ## Display the title
    ## ----------------------------
    &lt;div id="document-title"&gt;&lt;h1&gt;$titleToDisplay&lt;/h1&gt;&lt;/div&gt;
  &lt;/div&gt;
  #if($displayContentMenu)
    &lt;div class="col-xs-12 col-md-5"&gt;
      #template("menus_content.vm")
    &lt;/div&gt;
  #end
&lt;/div&gt;
##
## If the document cannot be edited, display an information and a forcing link:
##
#if (!$allowDocEdit)
  &lt;div&gt;
  $response.setStatus(423)
  #set($newquerystring = "$!{request.getQueryString().replaceAll('&amp;', '&amp;amp;').replaceAll('&amp;amp;amp;', '&amp;amp;')}&amp;amp;force=1")
  #set($forceEditURL = $doc.getURL($xcontext.action, ${newquerystring}))
  #xwikimessageboxstart($services.localization.render('notice') "$services.localization.render('doclockedby') $xwiki.getUserName($doc.getLockingUser())")
    &lt;a href="$forceEditURL"&gt;$services.localization.render('forcelock')&lt;/a&gt;
  #xwikimessageboxend()
  &lt;/div&gt;
#else
##
## Otherwise, can edit - continue the form.
##
&lt;div&gt;
&lt;input type="hidden" name="xcontinue" value="$doc.getURL($doc.getDefaultEditMode(), 'editor=inline')"/&gt;
## CSRF prevention
&lt;input type="hidden" name="form_token" value="$!{services.csrf.getToken()}" /&gt;
## This input is used by the full screen widget: it stores the selector of the maximized element, so that the full screen can be restored when coming back from preview.
&lt;input type="hidden" name="x-maximized" value="$!{escapetool.xml(${request.get('x-maximized')})}" /&gt;
&lt;input type="hidden" name="xredirect" value="$!{escapetool.xml($request.get('xredirect'))}" /&gt;
&lt;input type="hidden" name="xnotification" value="$!{escapetool.xml($request.get('xnotification'))}" /&gt;
&lt;input type="hidden" name="template" value="$!{escapetool.xml($request.template)}" /&gt;
## We need to submit the language of the translated document because the inline edit mode is not limited to editing only
## the objects, which are shared by all translations. We can also edit the content or the title of the document which are
## specific to each translation and so we need to specify which translation is being edited.
&lt;input type="hidden" name="language" value="$!{escapetool.xml($tdoc.realLanguage)}" /&gt;
#if("$!request.parent" != '')
  &lt;input type="hidden" name="parent" value="$escapetool.xml($!request.parent)" /&gt;
#end
#if("$!request.title" != '')
  &lt;input type="hidden" name="title" value="$escapetool.xml($!request.title)" /&gt;
#end
## ----------------------------
## Display the rendered content
## ----------------------------
$renderedContent
#set($editactions = "bottom")
&lt;div class="bottombuttons"&gt;#template("editactions.vm")&lt;/div&gt;
&lt;/div&gt; ## form
&lt;/form&gt;
#template("textarea_wysiwyg.vm")
#end ## can edit
&lt;/div&gt; ## mainContentArea
&lt;/div&gt; ## main
</editinline.vm>
    </property>
    <property>
      <eescHeader.vm>###
### Header for EESC
###
### Provide functional buttons (create, edit, share, delete)
###
#set($isTask = false)
#set($task = $doc.getObject('TaskManager.TaskManagerClass'))
#if($!task)
  #set($isTask = true)
#end
#set($isProject = false)
#set($project = $doc.getObject('ProjectsCode.ProjectsCodeClass'))
#if($!project)
  #set($isProject = true)
#end
#set($hasProject = false)
#set($query = "from doc.object('ProjectsCode.ProjectsCodeClass') as project where doc.fullName not like '%Template'")
#if($services.query.xwql($query).execute().size() &gt; 0)
  #set($hasProject = true)
#end
#########
#includeInContext("EESCCode.GlobalVars")
#########
#set($documentref = $services.model.resolveDocument($doc.fullName))
#set($projectshareref = $services.model.createDocumentReference($services.wiki.currentWikiId, 'EESCCode', 'ProjectShare'))
#set($projectcreateref = $services.model.createDocumentReference($services.wiki.currentWikiId, 'EESCCode', 'ProjectCreate'))
#set($tasktemplateref = $services.model.createDocumentReference($services.wiki.currentWikiId, 'EESCCode', 'TaskManagerTemplate'))
#set($taskname = $services.localization.render('eesc.home.task') + $xwiki.getUserName($context.getUser(),false) + $datetool.get('yyyyMdHms'))
#set($newtaskname = "$xwiki.getUniquePageName('TaskManager',$taskname)")

#set($newtaskref = $services.model.createDocumentReference($services.wiki.currentWikiId, 'TaskManager',$newtaskname))
&lt;style type="text/css"&gt;
.form-inline {
  display: inline-block;
}
.text-right {
  float: right;
}
&lt;/style&gt;
&lt;span class="text-left"&gt;
  &lt;form class="form-inline" method="GET" action="${xwiki.getURL($projectcreateref)}"&gt;
    &lt;input type="hidden" name="step" value="form" /&gt;
    &lt;input type="hidden" name="referer" value="${doc.fullName}" /&gt;
    &lt;input type="submit" class="btn btn-success" value="${services.localization.render('eesc.template.eescheader.create.project')}" /&gt;
  &lt;/form&gt;
  #if($hasProject)
    &lt;form class="form-inline" method="GET" action="${xwiki.getURL($newtaskref,'edit')}"&gt;
      &lt;input type="hidden" name="template" value="${tasktemplateref}" /&gt;
      #if($isProject)
        &lt;input type="hidden" name="TaskManager.TaskManagerClass_0_project" value="${doc}" /&gt;
        &lt;input type="hidden" name="parent" value="${doc}" /&gt;
      #else
        &lt;input type="hidden" name="parent" value="Main.WebHome" /&gt;
      #end
	  #set($showNewTaskBtn = false)
	  #if($isProject)
	    #if($hasEdit)
			#set($showNewTaskBtn = true)
		#end
	  #else
		#set($showNewTaskBtn = true)
	  #end
		#if($showNewTaskBtn &amp;&amp; $hasProjectsEditRights)
			&lt;input type="submit" class="btn btn-success" value="${services.localization.render('eesc.template.eescheader.create.task')}" /&gt;
		#end
	&lt;/form&gt;
  #end
&lt;/span&gt;
&lt;span class="text-right"&gt;
  #if(!$doc.isHidden() &amp;&amp; $hasEdit)
    &lt;form class="form-inline" method="GET" action="${xwiki.getURL($documentref, 'edit', '')}"&gt;
      &lt;input type="submit" class="btn btn-primary" value="${services.localization.render('eesc.template.eescheader.project.edit')}" /&gt; 
    &lt;/form&gt;
    #if($doc.hasAccessLevel("delete"))
      #if($isProject)
      &lt;form class="form-inline" method="GET" action="${xwiki.getURL($projectshareref, 'view', '')}"&gt;
        &lt;input type="hidden" name="step" value="form" /&gt;
        &lt;input type="hidden" name="projectname" value="${doc.name}" /&gt;
        &lt;input type="submit" class="btn btn-primary" value="${services.localization.render('eesc.template.eescheader.project.share')}" /&gt; 
      &lt;/form&gt;
      &lt;form class="form-inline" method="GET" action="${xwiki.getURL($documentref, 'delete', '')}"&gt;
        &lt;input type="submit" class="btn btn-danger" value="${services.localization.render('eesc.template.eescheader.project.delete')}" /&gt; 
      &lt;/form&gt;
    #end
  #end
#end
&lt;/span&gt;
</eescHeader.vm>
    </property>
    <property>
      <eescTitle.vm>###
### Title for EESC
###
&lt;style type="text/css"&gt;
.eesc-service-title {
  color: gray;
}
&lt;/style&gt;
&lt;h1 class="eesc-service-title"&gt;${services.localization.render('eesc.service.name')}&lt;/h1&gt;
#if($doc.parent &amp;&amp; $doc.parent == '')
  &lt;hr /&gt;
#end
</eescTitle.vm>
    </property>
    <property>
      <footer.vm/>
    </property>
    <property>
      <header.vm/>
    </property>
    <property>
      <layoutExtraVars.vm>#* 
 * Voluntary left empty.
 * This template is intended to be used by custom skin that want to override values from layoutvars.vm safely.
 *  
 * Some example of variables that can be overridden here :
 * #set($displayContentMenu = false)
 * #set($displayMainMenu = false)
 * #set($displayDocExtra = false)
 * #set($displayShortcuts = false)
 *#
 
#set($currentUser = $xwiki.user.user.toString())
#set($adminDoc = $xwiki.getDocument('xwiki:XWiki.XWikiAdminGroup'))
#set($adminObj = $adminDoc.getObject('XWiki.XWikiGroups', 'member', $currentUser.replace('xwiki:', '')))

#if(!$adminObj)
  #set($displayContentMenu = false)
  #set($displayMainMenu = false)
  ##set($displayDocExtra = false)
  #set($displayShortcuts = false)
#end

#set($eescForbiddenSpaces = [])
#set($discard = $eescForbiddenSpaces.add('AnnotationCode'))
#set($discard = $eescForbiddenSpaces.add('AppWithinMinutes'))
#set($discard = $eescForbiddenSpaces.add('Collections'))
#set($discard = $eescForbiddenSpaces.add('ColorThemes'))
#set($discard = $eescForbiddenSpaces.add('EESCCode'))
#set($discard = $eescForbiddenSpaces.add('Import'))
#set($discard = $eescForbiddenSpaces.add('Invitation'))
#set($discard = $eescForbiddenSpaces.add('Main'))
#set($discard = $eescForbiddenSpaces.add('Menu'))
#set($discard = $eescForbiddenSpaces.add('Panels'))
#set($discard = $eescForbiddenSpaces.add('Scheduler'))
#set($discard = $eescForbiddenSpaces.add('Stats'))
#set($discard = $eescForbiddenSpaces.add('SyntaxHighlighting'))
#set($discard = $eescForbiddenSpaces.add('Watch'))
#set($discard = $eescForbiddenSpaces.add('WatchAdmin'))
#set($discard = $eescForbiddenSpaces.add('WatchCode'))
#set($discard = $eescForbiddenSpaces.add('WatchSheets'))
#set($discard = $eescForbiddenSpaces.add('WikiManager'))
#set($discard = $eescForbiddenSpaces.add('XApp'))
#set($discard = $eescForbiddenSpaces.add('XAppClasses'))
#set($discard = $eescForbiddenSpaces.add('XAppSheets'))
#set($discard = $eescForbiddenSpaces.add('XAppTemplates'))
#set($discard = $eescForbiddenSpaces.add('XWiki'))
</layoutExtraVars.vm>
    </property>
    <property>
      <logo/>
    </property>
    <property>
      <name>EESC Skin</name>
    </property>
    <property>
      <preview.vm>#template("startpage.vm")
&lt;div class="main layoutsubsection"&gt;
&lt;div id="mainContentArea"&gt;
&lt;div class="topbuttons"&gt;#template("previewactions.vm")&lt;hr /&gt;&lt;/div&gt;
#template("eescTitle.vm")
#template("hierarchy.vm")
#template("contentview.vm")
&lt;div class="bottombuttons"&gt;&lt;hr /&gt;#template("previewactions.vm")&lt;/div&gt;
&lt;/div&gt; ## mainContentArea
&lt;/div&gt; ## main
#template("endpage.vm")
</preview.vm>
    </property>
    <property>
      <style.css/>
    </property>
    <property>
      <uorgsuggest.vm>$response.setContentType("text/xml")
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;results&gt;
#macro (suggestUsersOrGroups)
  #set ($input = "$!request.input.toLowerCase()")
  #if ($input.length() &gt; 0)
    ## Resolve the input as a user/group reference and use only the document name for matching.
    #set ($input = $services.model.resolveDocument($input).name)
  #end
  #if ($request.uorg == 'user')
    #set ($statement = "from doc.object(XWiki.XWikiUsers) as user where lower(doc.name) like :input or concat(concat(lower(user.first_name), ' '), lower(user.last_name)) like :input order by user.first_name, user.last_name")
  #else
    ##set ($statement = 'from doc.object(XWiki.XWikiGroups) as groups where lower(doc.name) like :input and doc.fullName &lt;&gt; ''XWiki.XWikiGroupTemplate'' order by doc.name')
    #set ($statement = 'from doc.object(XWiki.XWikiGroups) as groups where (lower(doc.name) like :input or lower(doc.title) like :input) and doc.fullName &lt;&gt; ''XWiki.XWikiGroupTemplate'' order by doc.name, doc.title')
  #end
  #set ($query = $services.query.xwql($statement).setWiki($wikiReference.name).addFilter('unique'))
  #set ($discard = $query.setOffset(0).setLimit(10).bindValue('input', "%$input%"))
  #foreach ($result in $query.execute())
    #displayResult($result)
  #end
#end

#macro (displayResult $result)
  #if ($request.uorg == 'user')
     #set($projectRightsManager = $xwiki.parseGroovyFromPage("EESCCode.ProjectRightsManagerGroovy"))
     #set($discard = $projectRightsManager.init($xwiki, $context, $services))
     #if($request.project &amp;&amp; "$request.project" != "")
       #set($filterByProject = true)
       #set($projectRights = $projectRightsManager.getProjectRights($request.project))
       #set($projectCreator = $projectRights.get("projectCreator"))
       #set($projectEditGroups = $projectRights.get("editGroups"))
       #set($projectEditUsers = $projectRights.get("editUsers"))
     #end
  #end
  #set ($reference = $services.model.resolveDocument($result, $wikiReference))
  ## Make sure we use relative references as much as possible. See XWIKI-10046.
  #set ($stringReference = $services.model.serialize($reference, 'compactwiki'))
  #getUserAvatarURL($reference $avatarURL 30)
  #if($request.uorg == 'user')
    ## The string returned by XWiki#getUserName() is XML encoded.
    #set ($prettyName = $xwiki.getUserName($stringReference, false))
  #else
    #set ($prettyName = $xwiki.getDocument($reference).plainTitle)
    #if ("$!prettyName" == '')
      #set ($prettyName = $reference.name)
    #end
  #end
  #if($request.uorg == 'user' &amp;&amp; $filterByProject)
   #set($showItem = false)
   #if($projectEditGroups.contains("XWiki.XWikiAllGroup"))
      #set($showItem = true)
   #else
     #if(($projectCreator == $stringReference) || $projectEditUsers.contains($stringReference))
       #set($showItem = true)  
     #end
     ## Check if the result belongs to a group that can edit the project
     #foreach($g in $projectEditGroups)
        #set($usr = $xwiki.getUser($stringReference))
        #if($usr &amp;&amp; $usr.isUserInGroup($g))
           #set($showItem = true)
        #end
     #end
   #end
    #if($showItem)
       &lt;rs id="$escapetool.xml($reference.name)" icon="$escapetool.xml($avatarURL.url)"
       info="$prettyName"&gt;$escapetool.xml($stringReference)&lt;/rs&gt;
       #end
  #else
    &lt;rs id="$escapetool.xml($reference.name)" icon="$escapetool.xml($avatarURL.url)"
    info="$prettyName"&gt;$escapetool.xml($stringReference)&lt;/rs&gt;
  #end
#end

#if ($request.wiki == 'global')
  #set ($wikiReference = $services.model.createWikiReference($xcontext.mainWikiName))
#else
  #set ($wikiReference = $doc.documentReference.wikiReference)
#end
#if ($request.exactMatch == 'true')
  ## This is normally used for loading the initial selection.
  #displayResult("$!request.input")
#else
  #suggestUsersOrGroups()
#end
&lt;/results&gt;
</uorgsuggest.vm>
    </property>
    <property>
      <view.vm>###
### Main "view" template
###
### General wrapper for view actions
###
#if ($services.distribution.jobStatus &amp;&amp; $services.distribution.jobStatus.state.name() != 'FINISHED' &amp;&amp; $services.distribution.canDisplayDistributionWizard())
  $response.sendRedirect($xwiki.getURL('XWiki.Distribution', 'distribution', "xredirect=$escapetool.url($xwiki.relativeRequestURL)"))
#elseif ($request.getParameter("raw").equals("1"))
  #template("code.vm")
#else
  #template("startpage.vm")
  
  #if("$!viewer" == '')
    #set($viewer = $request.getParameter('viewer'))
  #end
  #if("$!viewer" == '')
    #set($viewer = 'content')
  #end
  
  &lt;div class="main"&gt;
  &lt;div id="mainContentArea"&gt;
  #template("eescTitle.vm")
  #template("hierarchy.vm")
  #template("eescHeader.vm")
  #if($viewer == 'content')
    #template("contentview.vm")
  #else
    #template("${viewer}.vm")
  #end
  &lt;div class="clearfloats"&gt;&lt;/div&gt;
  &lt;/div&gt;## mainContentArea
  #if($viewer == 'content' &amp;&amp; $displayDocExtra)
    #template("docextra.vm")
  #end
  &lt;/div&gt;## main
  #template("endpage.vm")
#end
</view.vm>
    </property>
    <property>
      <viewheader.vm/>
    </property>
  </object>
</xwikidoc>
